name: üîÑ Sync to GitLab

on:
  push:
    branches: [main, master]

jobs:
  mirror:
    runs-on: ubuntu-latest
    steps:
      - name: üì• Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          
      - name: üõ†Ô∏è Debug Info
        run: |
          echo "GitLab User: ${{ secrets.GITLAB_USERNAME }}"
          echo "Token exists: ${{ secrets.GITLAB_TOKEN != '' }}"
          
      - name: üöÄ Push to GitLab
        env:
          GITLAB_USER: "${{ secrets.GITLAB_USERNAME }}"
          GITLAB_TOKEN: "${{ secrets.GITLAB_TOKEN }}"
          GITLAB_PROJECT: "cinema-project-laravel"  # REMPLACEZ par votre nom de repo
        run: |
          # Format correct pour GitLab (IMPORTANT !)
          git remote add gitlab https://oauth2:${GITLAB_TOKEN}@gitlab.com/${GITLAB_USER}/${GITLAB_PROJECT}.git
          
          # Afficher pour debug
          echo "Pushing to: https://gitlab.com/${GITLAB_USER}/${GITLAB_PROJECT}.git"
          
          # Essayer le push
          git push gitlab HEAD:main --force
          
          echo "‚úÖ Sync successful!"
